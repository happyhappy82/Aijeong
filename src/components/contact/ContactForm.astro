---
// No props needed for this component
---

<div id="contact-form-wrapper">
  <form id="contact-form" class="space-y-5">
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-5">
      <div>
        <label for="name" class="block text-sm font-medium mb-2">
          이름 <span class="text-red-500">*</span>
        </label>
        <input
          id="name"
          name="name"
          type="text"
          required
          class="w-full px-4 py-3 rounded-lg bg-muted border border-border text-foreground focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all"
          placeholder="홍길동"
        />
      </div>
      <div>
        <label for="email" class="block text-sm font-medium mb-2">
          이메일 <span class="text-red-500">*</span>
        </label>
        <input
          id="email"
          name="email"
          type="email"
          required
          class="w-full px-4 py-3 rounded-lg bg-muted border border-border text-foreground focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all"
          placeholder="example@company.com"
        />
      </div>
    </div>
    <div>
      <label for="company" class="block text-sm font-medium mb-2">
        회사/기관명
      </label>
      <input
        id="company"
        name="company"
        type="text"
        class="w-full px-4 py-3 rounded-lg bg-muted border border-border text-foreground focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all"
        placeholder="(주)회사명"
      />
    </div>
    <div>
      <label for="message" class="block text-sm font-medium mb-2">
        문의 내용 <span class="text-red-500">*</span>
      </label>
      <textarea
        id="message"
        name="message"
        required
        rows="5"
        class="w-full px-4 py-3 rounded-lg bg-muted border border-border text-foreground focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all resize-none"
        placeholder="교육 주제, 대상, 기간, 인원 등을 알려주세요."
      ></textarea>
    </div>

    <div id="error-message" class="hidden flex items-center gap-2 text-red-500 text-sm">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      전송에 실패했습니다. 다시 시도해 주세요.
    </div>

    <button
      type="submit"
      id="submit-btn"
      class="w-full inline-flex items-center justify-center font-semibold rounded-lg transition-all duration-300 cursor-pointer bg-accent text-white hover:bg-accent-hover shadow-lg hover:shadow-xl px-8 py-4 text-lg"
    >
      <span id="submit-text">문의 보내기</span>
      <svg id="submit-icon" class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
      </svg>
    </button>
  </form>

  <div id="success-message" class="hidden text-center py-12">
    <svg class="w-16 h-16 text-accent mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
    <h3 class="text-xl font-bold mb-2">문의가 접수되었습니다</h3>
    <p class="text-muted-foreground">
      빠른 시일 내에 답변 드리겠습니다. 감사합니다.
    </p>
    <button
      id="reset-btn"
      class="mt-6 text-accent hover:underline cursor-pointer"
    >
      새 문의하기
    </button>
  </div>
</div>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement;
  const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement;
  const submitText = document.getElementById('submit-text') as HTMLSpanElement;
  const submitIcon = document.getElementById('submit-icon') as HTMLElement;
  const errorMessage = document.getElementById('error-message') as HTMLDivElement;
  const successMessage = document.getElementById('success-message') as HTMLDivElement;
  const resetBtn = document.getElementById('reset-btn') as HTMLButtonElement;

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    // Disable button and show loading state
    submitBtn.disabled = true;
    submitText.textContent = '전송 중...';
    submitIcon.classList.add('hidden');
    errorMessage.classList.add('hidden');

    // Get form data
    const formData = new FormData(form);
    const data = {
      access_key: import.meta.env.PUBLIC_WEB3FORMS_KEY,
      name: formData.get('name'),
      email: formData.get('email'),
      company: formData.get('company'),
      message: formData.get('message'),
      subject: `[에이정 문의] ${formData.get('company')} - ${formData.get('name')}`,
    };

    try {
      const response = await fetch('https://api.web3forms.com/submit', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data),
      });

      if (response.ok) {
        // Show success message
        form.classList.add('hidden');
        successMessage.classList.remove('hidden');
      } else {
        throw new Error('Submit failed');
      }
    } catch (error) {
      // Show error message
      errorMessage.classList.remove('hidden');
      submitBtn.disabled = false;
      submitText.textContent = '문의 보내기';
      submitIcon.classList.remove('hidden');
    }
  });

  resetBtn.addEventListener('click', () => {
    // Reset form
    form.reset();
    form.classList.remove('hidden');
    successMessage.classList.add('hidden');
    errorMessage.classList.add('hidden');
    submitBtn.disabled = false;
    submitText.textContent = '문의 보내기';
    submitIcon.classList.remove('hidden');
  });
</script>
